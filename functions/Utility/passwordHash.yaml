# Scraped from: https://wiki.multitheftauto.com/wiki/PasswordHash
shared:
  name: passwordHash
  description: This function creates a new password hash using a specified hashing
    algorithm.
  parameters:
  - name: password
    type: string
    description: The password to hash.
  - name: algorithm
    type: string
    description: 'The algorithm to use: bcrypt : use the bcrypt hashing algorithm.
      Hash length: 60 characters. Note that only the prefix $2y$ is supported (older
      prefixes can cause security issues).'
  - name: options
    type: table
    description: table with options for the hashing algorithm, as detailed below.
  - name: callback
    type: function
    description: providing a callback will run this function asynchronously, the arguments
      to the callback are the same as the returned values below.
  examples:
  - path: examples/passwordHash-1.lua
    description: ''
    side: server
  returns:
    values:
    - type: string
      name: value
    description: Returns the hash as a string if hashing was successful, false otherwise.
      If a callback was provided, the aforementioned values are arguments to the callback,
      and this function will always return true .
  notes:
  - type: info
    content: Using passwordHash is the recommended way of storing passwords.
  - type: warning
    content: It is strongly recommended to use the async version of the function (i.e.
      provide a callback function). Otherwise, you will experience short freezes due
      to the slow nature of the bcrypt algorithm
  - type: warning
    content: If you will be using "Example 1" then you will have to save account data
      "hash_password" after server restart, otherwise this script will no longer work.
  meta:
  - needs_checking: 'This function was partially migrated from the old wiki. Please
      review manually:

      - Missing section: Options for each hashing algorithm

      '
  requires_review: true
